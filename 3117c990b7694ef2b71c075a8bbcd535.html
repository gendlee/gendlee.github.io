<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🦜&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>0006 优雅与高效的java编程手记(1-20)&nbsp;|&nbsp;锡安的自留地</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="0006 优雅与高效的java编程手记(1-20)">
  
    <meta name="description" content="《Effective Java》阅读手记">
    <meta property="og:description" content="《Effective Java》阅读手记">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;♨️&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🦜&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="e48d9ceebf4c4de2b657c3a3d1d308f4.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧰&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>工具</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🎏&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>关于我</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/met_william_morris_1875.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;♨️&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">0006 优雅与高效的java编程手记(1-20)</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Apr 16, 2022</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/JAVA.html">JAVA</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/3117c990b7694ef2b71c075a8bbcd535" class="PageRoot"><div id="https://www.notion.so/d0c2c4671cce4ac1867e7e7990506266" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/877279622fb34668b7d902db044a15ab" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">🗣</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">本系列文章为《Effective Java 3rd Edition》的阅读手记，该著作中提供了90条java的编程建议，都是从实战中总结出的高阶经验。结合实际开发中的使用频率，对有的条目详细解读和实践，对于一些不常用的条目，就当走个意识，真正实践中遇到再回头细读。</span></span></p></div><h2 id="https://www.notion.so/cb811066293f4ee28adeeb5c59e15b72" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/cb811066293f4ee28adeeb5c59e15b72"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1、静态工厂替代构造方法</strong></mark></span></span></h2><div id="https://www.notion.so/9db1e5d53c614a359ad918af98d5b315" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">优点：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/87eb48e581d44aa7813a5ab0637b1361" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">有自己的名字，可读性强</span></span></li><li id="https://www.notion.so/ba1d27732c01491eaaaad85fed7be82f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">无需每次调用都创建新对象</span></span></li><li id="https://www.notion.so/8bdd2417455b4f1d98a70157ae8e7127" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">可以返回方法返回类型的任何子类型的对象</span></span></li><li id="https://www.notion.so/599c737843fa420f991594029fa81359" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">返回对象类可以根据输入参数的不同而不同</span></span></li><li id="https://www.notion.so/2b46cf716a9d4dcbb3808a191b2a49a5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">编写包含该方法的类时，返回的对象的类不需要存在</span></span></li></ul><div id="https://www.notion.so/87aed1b56c9b4270acff19702589cfca" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">缺点：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/5c9e5748e7ed4c94b9a88c078446cccd" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果只提供了静态工厂方法，没有公共或受保护构造方法的类不能被子类化</span></span></li><li id="https://www.notion.so/f89dafedb7fc4f3bb6d26000ef412496" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">接口文档中不好找</span></span></li><li id="https://www.notion.so/e90a97fc60e54f4e932a29f1d73f3a31" class="BulletedList"><span class="SemanticStringArray"></span></li></ul><div id="https://www.notion.so/a5fb838064e84eee979578542f692179" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">常用的静态方法命名：</span></span></p></div><div id="https://www.notion.so/81d65f4c7c2c454096b241c977010511" class="CollectionInline"><h3><a class="Anchor" href="#https://www.notion.so/81d65f4c7c2c454096b241c977010511"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">常用静态方法名称</span></span></h3><div class="Table"><table><thead><tr><th>常用名称</th><th>含义</th><th>优雅示例</th></tr></thead><tbody><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">from</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/acbbec10538b4cdc933a4cefda5f4dc6"><span class="SemanticStringArray"><span class="SemanticString">类型转换方法，接受单个参数并返回此类型的相应实例</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Date d = Date.from(instant)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">of</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/2d91e0555dda461d8f0244b6cedfe2bd"><span class="SemanticStringArray"><span class="SemanticString">聚合方法，接受多个参数并返回该类型的实例，并把他们合并在一起</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Set faceCards = EnumSet.of(JACK, QUEEN, KING)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">valueOf</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/711c441a62fe48ec8c487834fe09c003"><span class="SemanticStringArray"><span class="SemanticString">from 和 to 更为详细的替代 方式</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">BigInteger prime = BigInteger.valueOf(Integer.MAX_VALUE)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">instancee</strong></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"> 或 </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">getinstance</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/953ad6db60844bccacfb97523f2271c0"><span class="SemanticStringArray"><span class="SemanticString">返回一个由其参数 (如果有的话) 描述的实例</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">StackWalker luke = StackWalker.getInstance(options)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">create</strong></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"> 或 </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">newInstance</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/0673451588454a23b0c309a6dbdc90a7"><span class="SemanticStringArray"><span class="SemanticString">同上</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Object newArray = Array.newInstance(classObject, arrayLen)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">getType</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/52d00c754ea445d38b94917ff320411d"><span class="SemanticStringArray"><span class="SemanticString">与 getInstance 类似</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">FileStore fs = Files.getFileStore(path)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">newType</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/0d75d5ef7d614d76acffc77b59c217c5"><span class="SemanticStringArray"><span class="SemanticString">与 newInstance 类似</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">BufferedReader br = Files.newBufferedReader(path)</code></span></span></td></tr><tr><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">type</strong></mark></span></span></td><td class="Table__CellTitle"><a href="https://www.notion.so/41ad94c2dcad4b979565144fe61cdf2b"><span class="SemanticStringArray"><span class="SemanticString">getType 和 newType 简洁的替代方式</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">List litany = Collections.list(legacyLitany);</code></span></span></td></tr></tbody></table></div></div><h2 id="https://www.notion.so/ea048e6d62c745879ad5f4441cab5429" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ea048e6d62c745879ad5f4441cab5429"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">2、当构造方法参数过多时使用 builder 模式</strong></mark></span></span></h2><div id="https://www.notion.so/15fe1565d6f648f5a76d9c57ca1cda85" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们在创建类的时候，通常的定义方式如下：</span></span></p></div><pre id="https://www.notion.so/9615b79b7c5d49548a62a6d23afc51bf" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> c<span class="token punctuation">;</span>
    <span class="token comment">// constructor with parameters</span>
    <span class="token keyword">public</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> a<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> b<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>c <span class="token operator">=</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// defalut constructor</span>
    <span class="token keyword">public</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// setters and getters are omitted</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/5d35c885d5f14fada19b9e7c9fe3c95e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在使用这个类的时候，通常会使用带参数的构造函数，对不需要设置的参数采用默认值，创建方式为：</span></span></p></div><pre id="https://www.notion.so/b36149811ee94282a956a2b3e593915c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">A</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 其中c设置了默认值0</span></span></span></span></code></pre><div id="https://www.notion.so/2d9d38e042b04492bd3c051502776eda" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">或使用默认构造函数（JavaBeans 模式）创建：</span></span></p></div><pre id="https://www.notion.so/eab4b47718524fe090e034e4007301bd" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">A</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">setA</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">setB</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">setC</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span></span></code></pre><div id="https://www.notion.so/935da6484d074c299b1984ca7c5176ce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以上创建类的方式分别为可伸缩方式和JavaBeans模式，但存在以下缺点：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/9bfc3c84e2aa44758c6d1e2a3aa13d8c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">可伸缩构造方法模式需要为不关心的参数设置默认值，当参数非常多的时候，这种方式容易参数错位，比如类A创建时被写成</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">A obj = new A(1, 0, 2)</code></span><span class="SemanticString">，实际上要求</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">c=0</code></span><span class="SemanticString">，这就会产生灾难性的bug。另一方面对于阅读者也很不友好，即不够优雅</span></span></li><li id="https://www.notion.so/8f09fcfe2a044705a966f8a9134b4382" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">JavaBeans模式实际上会存在线程安全问题</span></span></li></ul><div id="https://www.notion.so/045aabe9b8554b1882c88cec4f7c5c46" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">基于以上问题，业界给出优雅的解决方式，最典型的要数</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">scala</strong></span><span class="SemanticString">语言，比如在</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">spark streaming</strong></span><span class="SemanticString">中创建一个上下文，代码如下：</span></span></p></div><pre id="https://www.notion.so/9ae4902925c44c3483280f3485bf7f83" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>object <span class="token class-name">SparkStreaming</span> <span class="token punctuation">{</span>
  def <span class="token function">printWebsites</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span><span class="token operator">=</span> <span class="token punctuation">{</span>
    val conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SparkConf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setMaster</span><span class="token punctuation">(</span><span class="token string">"local[2]"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setAppName</span><span class="token punctuation">(</span><span class="token string">"PrintWebsites"</span><span class="token punctuation">)</span>

    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/2cc60caaf9a6466e907a317c3e2903e1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们可以看到上面</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">SparkConf</code></span><span class="SemanticString">类的创建，采用了</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">链式赋值</strong></span><span class="SemanticString">的方式，对于需要使用默认值的参数可以省略赋值，这样的结构看起来就清晰简单，也不会出现伸缩式构造函数可能出现的参数错位。</span></span></p></div><div id="https://www.notion.so/2a4ded88cbe745af9abd510a31a4d1bb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">下面我们来看一个创建java线程池配置类的例子，从中感受两种方式的差异。</span></span></p></div><pre id="https://www.notion.so/3103687855b540c7abc2828ead4a5824" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// 可伸缩构造函数方式</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigContext</span> <span class="token punctuation">{</span>
    <span class="token comment">// Required</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> corePoolSize<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">;</span>

    <span class="token comment">// Optional</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span> workQueue<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> enableAbortPolicy<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> enableDiscardPolicy<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> enableDiscardOldestPolicy<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> enableCallerRunsPolicy<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ConfigContext</span><span class="token punctuation">(</span>
            <span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span>
            <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span>
            <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>
            <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span>
            <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span> workQueue<span class="token punctuation">,</span>
            <span class="token keyword">boolean</span> enableAbortPolicy<span class="token punctuation">,</span>
            <span class="token keyword">boolean</span> enableDiscardPolicy<span class="token punctuation">,</span>
            <span class="token keyword">boolean</span> enableDiscardOldestPolicy<span class="token punctuation">,</span>
            <span class="token keyword">boolean</span> enableCallerRunsPolicy<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>corePoolSize <span class="token operator">=</span> corePoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maximumPoolSize <span class="token operator">=</span> maximumPoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keepAliveTime <span class="token operator">=</span> keepAliveTime<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>unit <span class="token operator">=</span> unit<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>workQueue <span class="token operator">=</span> workQueue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>enableAbortPolicy <span class="token operator">=</span> enableAbortPolicy<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>enableDiscardPolicy <span class="token operator">=</span> enableDiscardPolicy<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>enableDiscardOldestPolicy <span class="token operator">=</span> enableDiscardOldestPolicy<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>enableCallerRunsPolicy <span class="token operator">=</span> enableCallerRunsPolicy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// setters and getters are omitted</span></span></span></span></code></pre><div id="https://www.notion.so/de62bb196ede4c69aaf23f75c61319a2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">因此我们创建一个</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">ConfigContext</code></span><span class="SemanticString">时就会这样写：</span></span></p></div><pre id="https://www.notion.so/c09c8a2ba87442c3bf4c68c4dd6953de" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notGood</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 每个参数都要传值</span>
        <span class="token class-name">ConfigContext</span> configContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConfigContext</span><span class="token punctuation">(</span>
                <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token number">1000</span><span class="token punctuation">,</span>
                <span class="token number">3600</span><span class="token punctuation">,</span>
                <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/d30e52ed81ba4fa1a663d1d20e445e9a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">或：</span></span></p></div><pre id="https://www.notion.so/a8edba4735704c588968435d2f38eab3" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notGood2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ConfigContext</span> configContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConfigContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    configContext<span class="token punctuation">.</span><span class="token function">setCorePoolSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configContext<span class="token punctuation">.</span><span class="token function">setMaximumPoolSize</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configContext<span class="token punctuation">.</span><span class="token function">setKeepAliveTime</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configContext<span class="token punctuation">.</span><span class="token function">setUnit</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configContext<span class="token punctuation">.</span><span class="token function">setWorkQueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinkedBlockingDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configContext<span class="token punctuation">.</span><span class="token function">enableAbortPolicy</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/7d9ae045130a49fc9e1b52013a8777b2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果采用</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">builder模式</strong></mark></span><span class="SemanticString">，会采用如下方式设置参数：</span></span></p></div><pre id="https://www.notion.so/fc5e1f7e31ec454a912d5f76dde8fbb4" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// 可伸缩构造函数方式</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigContext</span> <span class="token punctuation">{</span>
    <span class="token comment">// 属性同上</span>

    <span class="token comment">// 创建一个静态方法Builder</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>
        <span class="token comment">// Required</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> corePoolSize<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">;</span>

        <span class="token comment">// Optional</span>
        <span class="token keyword">private</span> <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span> workQueue<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">boolean</span> enableAbortPolicy<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">boolean</span> enableDiscardPolicy<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">boolean</span> enableDiscardOldestPolicy<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">boolean</span> enableCallerRunsPolicy<span class="token punctuation">;</span>

        <span class="token comment">// setters and getters are omitted</span>

        <span class="token comment">// 为必须参数赋值</span>
        <span class="token keyword">public</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span> <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>corePoolSize <span class="token operator">=</span> corePoolSize<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>maximumPoolSize <span class="token operator">=</span> maximumPoolSize<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 创建设置函数，并返回Builder本身，这是实现链式赋值的关键步骤</span>
        <span class="token keyword">public</span> <span class="token class-name">Builder</span> <span class="token function">keepAliveTime</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            keepAliveTime <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token comment">// 返回Builder</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 其他参数设置方式同上，省略</span>

    <span class="token punctuation">}</span>

    <span class="token comment">// 创建一个私有构造函数</span>
    <span class="token keyword">private</span> <span class="token class-name">ConfigContext</span><span class="token punctuation">(</span><span class="token class-name">Builder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        corePoolSize <span class="token operator">=</span> builder<span class="token punctuation">.</span>corePoolSize<span class="token punctuation">;</span>
        maximumPoolSize <span class="token operator">=</span> builder<span class="token punctuation">.</span>maximumPoolSize<span class="token punctuation">;</span>
        keepAliveTime <span class="token operator">=</span> builder<span class="token punctuation">.</span>keepAliveTime<span class="token punctuation">;</span>
        unit <span class="token operator">=</span> builder<span class="token punctuation">.</span>unit<span class="token punctuation">;</span>
        workQueue <span class="token operator">=</span> builder<span class="token punctuation">.</span>workQueue<span class="token punctuation">;</span>
        enableAbortPolicy <span class="token operator">=</span> builder<span class="token punctuation">.</span>enableAbortPolicy<span class="token punctuation">;</span>
        enableDiscardPolicy <span class="token operator">=</span> builder<span class="token punctuation">.</span>enableDiscardPolicy<span class="token punctuation">;</span>
        enableDiscardOldestPolicy <span class="token operator">=</span> builder<span class="token punctuation">.</span>enableDiscardOldestPolicy<span class="token punctuation">;</span>
        enableCallerRunsPolicy <span class="token operator">=</span> builder<span class="token punctuation">.</span>enableCallerRunsPolicy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/8c6abde740374904b9b319ffadc5f710" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其结构如图所示：</span></span></p></div><div id="https://www.notion.so/26b0b3b179bb45f189960b82c5541b0a" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb562e98f-1a4b-4a4e-b924-ca4b40ca11e0%2F%E9%9D%99%E6%80%81%E5%B7%A5%E5%8E%82%E5%88%9B%E5%BB%BA%E7%B1%BB.drawio.png?width=566&amp;table=block&amp;id=26b0b3b1-79bb-45f1-8996-0b82c5541b0a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb562e98f-1a4b-4a4e-b924-ca4b40ca11e0%2F%E9%9D%99%E6%80%81%E5%B7%A5%E5%8E%82%E5%88%9B%E5%BB%BA%E7%B1%BB.drawio.png?width=566&amp;table=block&amp;id=26b0b3b1-79bb-45f1-8996-0b82c5541b0a" style="width:566px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/575440ad2b3645a287389f8ddb20364b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">创建类的方式就变为了如下方式：</span></span></p></div><pre id="https://www.notion.so/e46edf32532f403bad3986a60d0be224" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prettyGood</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConfigContext</span> configContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">keepAliveTime</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">unit</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">workQueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinkedBlockingDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">enableAbortPolicy</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/00ee0e1a74884f8da984c9c84dfa4401" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">可见上述创建方式</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/42c773320bf141b6b999bc54f31712ec" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">由于没有提供可伸缩的构造函数，因此不会出现参数赋值错位的问题</span></span></li><li id="https://www.notion.so/a49caf2347b541608c529bf4f0e798ea" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">强制通过参数名称赋值，阅读性非常好</span></span></li><li id="https://www.notion.so/393b5d6dba214c998f117b8623f78511" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">builder比JavaBeans更安全</span></span></li></ul><div id="https://www.notion.so/ce38dd95e0854453b4900591dfdd3147" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">当然，使用builder静态工厂方式的缺点是：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/3fcfeb9f9e974d289426b3dfcad554f2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">builde创建比JavaBeans方式更复杂，在追求极致性能体验的场景要慎用</span></span></li><li id="https://www.notion.so/4f58f92fa64d44248f3ebf5bd324d494" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果一开始没有使用builder模式，在参数不断增加多到一定程度才切换到builder模式，转化过程具有一定风险，因此最好一开始就是使用builder模式</span></span></li></ul><h2 id="https://www.notion.so/033286fe26404d1787f2e4441e83b148" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/033286fe26404d1787f2e4441e83b148"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">4、使用私有构造方法执行非实例化</strong></mark></span></span></h2><h2 id="https://www.notion.so/6b2788b982b74fa9964792fe20d4394c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/6b2788b982b74fa9964792fe20d4394c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">5、依赖注入优于硬连接资源</strong></mark></span></span></h2><div id="https://www.notion.so/c59f0f9cee1c41819200fabc5cec0d54" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">不要使用单例或静态的实用类来实现一个类，该类依赖于一个或多个底层资源，这些资源的行为会影响类 的行为，并且不让类直接创建这些资源。相反，将资源或工厂传递给构造方法（或静态工厂或 builder 模式）。这种 称为依赖注入的实践将极大地增强类的灵活性、可重用性和可测试性。</span></span></p></div><div id="https://www.notion.so/af747bc616574bc7a1747b82f03b6e74" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在Spring工程项目中，通常我们可以看到这样的资源方法注入写法：</span></span></p></div><pre id="https://www.notion.so/3044f1076c6545598882ba75a9cc624b" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoServiceImpl</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CustomerInfoDao</span> customerInfoDao<span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/34ba168bfb2349b59ebfffe89b029585" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这个</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">customerInfoDao</code></span><span class="SemanticString">就是我们的链接资源类，通过依赖注入方式使用，而不是直接在</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">DemoServiceImpl</code></span><span class="SemanticString">中硬连接对应的资源。</span></span></p></div><h2 id="https://www.notion.so/9fc2e18a7faf4a24adc402234cac7f6b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/9fc2e18a7faf4a24adc402234cac7f6b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">6、避免创建不必要的对象</strong></mark></span></span></h2><div id="https://www.notion.so/2c9c885eab7c4c348ceedcada34f12a3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">创建不必要的对象，有以下问题：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/1b22b83acb5e4e6787d7763a83d85739" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">可能会出现</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">OOM</strong></span><span class="SemanticString">（OutOfMemerry）错误，因为类对象创建在JVM的堆内存中，堆内存是有限制的</span></span></li><li id="https://www.notion.so/627ebfef0fd541fc8b1782e1a8653b7d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">增加堆内存中垃圾回收的负担。创建不必要的对象后，可能会频繁触发GC操作，从而拖慢程序的处理速度。如果创建的对象出现内存泄露（Memerry Leak），同样也会出现OOM以及实际可使用堆内存更小，进一步增加GC频率</span></span></li></ul><div id="https://www.notion.so/975f8cbc628243919c2c53523f94b51e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如下方式是不建议的：</span></span></p></div><pre id="https://www.notion.so/70afcdfa87f64672aec4ea527b1f9f20" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// DON'T DO THIS</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"gendlee"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span></span></code></pre><div id="https://www.notion.so/04171e1b29ea425097f26c4b649d9bf0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">正确的做法：</span></span></p></div><pre id="https://www.notion.so/8d1541c5722444e7a3234026fdd34fdf" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// this is recommand</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"gendlee"</span><span class="token punctuation">;</span></span></span></span></code></pre><div id="https://www.notion.so/ce0faa8c9fad436189c4294820577a4d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其原因为：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/d935e0f8c9e042a8a8ac7df211826b4d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">String应该优先使用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">常量池</code></span><span class="SemanticString">中已有的字符串，而不是用new 的方式在堆上创建，堆上创建的String字符串，是无法复用的</span></span></li><li id="https://www.notion.so/1e8962c79bf4477a92bdea4bba61df56" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">new 对象会消耗更多性能</span></span></li></ul><div id="https://www.notion.so/1a9c380e2295464cb5be11d2ebb8e12a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">除此之外，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">优先使用基本类型而不是装箱的基本类型</strong></span><span class="SemanticString">。如下方式因为使用装箱的基本类型Long导致创建了2^31个Long对象：</span></span></p></div><pre id="https://www.notion.so/fae2792413bd4786bcd95c59b97d78ee" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Long</span> sum <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>  <span class="token comment">// 不应该使用装箱的基本类型</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/93f3d4fbdb734c25a0748ee7df70c468" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">应修改为：</span></span></p></div><pre id="https://www.notion.so/70ae69c00f974c709c19f9a744ed7673" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">long</span> sum <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>  <span class="token comment">// 使用基本类型</span></span></span></span></code></pre><div id="https://www.notion.so/e2caf3ebb6e44e85af2df6cff27c261f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">当然，不创建不必要的对象并不是绝对的，需要根据实际情况来判断。即当必须要创建一个对象的时候，就要创建，大不了就是开销点性能，但不能因为复用对象而引入</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">防御性赋值</strong></span><span class="SemanticString">（defensive copying）安全问题。</span></span></p></div><h2 id="https://www.notion.so/d4661d105b964e958815e6ffc36e1338" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d4661d105b964e958815e6ffc36e1338"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">7、消除过期的对象引用</strong></mark></span></span></h2><div id="https://www.notion.so/bcb2aac756054e64aa71fe1f09380e42" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">看这样一个类中的过期对象未消除的问题：</span></span></p></div><pre id="https://www.notion.so/7ffc58f5b9874dfbb5fa70e89723546f" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Stack</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elements<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EmptyStackException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> elements<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 这里栈中的第size个元素未消除引用</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/47ae6e0ff1dc40b4891ffeb6f569e855" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">正确的做法为：</span></span></p></div><pre id="https://www.notion.so/81b80e73b0564a09a0f3abbe35644d5f" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EmptyStackException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span> obj <span class="token operator">=</span> elements<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
    elements<span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 消除过期的引用</span>
    retrun obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/71c9786a5e254cfea538fe171cfbebc6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">清空对象引用应该是例外而不是规范，通常当一个类自己管理内存时，程序员应该警惕内存泄漏问题。另一个常见的内存泄漏来源是缓存，如果担心忘记清理，可以通过一个后台线程来定时清理。</span></span></p></div><h2 id="https://www.notion.so/4aaa11aad8314552b761251fe21be6ed" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/4aaa11aad8314552b761251fe21be6ed"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">8、避免使用 Finalizer 和 Cleaner 机制</strong></mark></span></span></h2><h2 id="https://www.notion.so/139c7571ed4547728eebdfc7cd28ca9e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/139c7571ed4547728eebdfc7cd28ca9e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">9、使用 try-with-resources 语句替代 try-finally 语句</strong></mark></span></span></h2><div id="https://www.notion.so/492715ab1b464af280ed5bdaf27e4f5c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在try中使用资源时，通常都需要非常留意资源使用完后的善后工作，一旦忘记处理可能会造成资源的浪费。譬如：</span></span></p></div><pre id="https://www.notion.so/f76239c89a97435ebbccbff420b65b4b" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">firstLineOfFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不建议的做法</span>
    <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/301550e8946a42b0b86210999802bbdb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果打开的不止一个资源，就会有多个try嵌套，代码冗长且阅读性不佳，正确的做法是使用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">try-with-resources</code></span><span class="SemanticString">：</span></span></p></div><pre id="https://www.notion.so/9fac1258d8e54413aaf41c5e3c5dc6bf" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// 推荐的做法</span>
<span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">firstLineOfFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/24e1008ef0834c9ca2f79c65efe425de" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在try语句中会自动关闭资源，安全而优雅。</span></span></p></div><h2 id="https://www.notion.so/27bb30246f64483593e2da68d69732b3" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/27bb30246f64483593e2da68d69732b3"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">10、重写 equals 方法时遵守通用约定</strong></mark></span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/165ac3df4885463394b077359ae75592" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">自反性</strong></span><span class="SemanticString">： 对于任何非空引用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x</code></span><span class="SemanticString">， </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.equals(x)</code></span><span class="SemanticString">必须返回true</span></span></li><li id="https://www.notion.so/a424c5eac3084db8b015452a1b1e7340" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">对称性</strong></span><span class="SemanticString">： 对于任何非空引用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">y</code></span><span class="SemanticString">，如果且仅当</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">y.equals(x)</code></span><span class="SemanticString"> 返回 true 时</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.equals(y)</code></span><span class="SemanticString">必须返回 true</span></span></li><li id="https://www.notion.so/ca025e1931104292ba85adf2ae5910ff" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">传递性</strong></span><span class="SemanticString">： 对于任何非空引用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x</code></span><span class="SemanticString">、</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">y</code></span><span class="SemanticString">、</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">z</code></span><span class="SemanticString">，如果</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.equals(y)</code></span><span class="SemanticString"> 返回 true， </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">y.equals(z)</code></span><span class="SemanticString"> 返回 true，则 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.equals(z)</code></span><span class="SemanticString">必须返回 true</span></span></li><li id="https://www.notion.so/4fbba53c894545758a404ed83d1ef98a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">一致性</strong></span><span class="SemanticString">： 对于任何非空引用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">y</code></span><span class="SemanticString">，如果在 equals 比较中使用的信息没有修改，则 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.equals(y)</code></span><span class="SemanticString">的多次调用 必须始终返回 true 或始终返回 false</span></span></li><li id="https://www.notion.so/60c0d9a2ee3441dabaf682fff7cbf13b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对于任何非空引用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x</code></span><span class="SemanticString">， </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.equals(null)</code></span><span class="SemanticString"> 必须返回 false</span></span></li></ul><div id="https://www.notion.so/14a0b8a4075d4241bac691f5afb759ae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以下是一些重要的提醒：</span></span></p></div><details id="https://www.notion.so/dcfa34df2e654e7c9d14c2a4168a3132" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle Toggle--Empty"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">当重写 equals 方法时，同时也要重写 hashCode 方法</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/09bee3e18a034e13a97fffff6447721b" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle Toggle--Empty"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">不要让 equals 方法试图太聪明。如果只是简单地测试用于相等的属性，那么要遵守 equals 约定并不困难。如果你在寻找相等方面过于激进，那么很容易陷入麻烦。一般来说，考虑到任何形式的别名通常是一个坏主意。 例如，File 类不应该试图将引用的符号链接等同于同一文件对象。幸好 File 类并没这么做</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/4f65641b407d4384bdb76d62165ebcf0" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle Toggle--Empty"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">在 equal 时方法声明中，不要将参数 Object 替换成其他类型。对于程序员来说，编写一个看起来像这样的 equals 方法并不少见，然后花上几个小时苦苦思索为什么它不能正常工作：在 equal 时方法声明中，不要将参数 Object 替换成其他类型。对于程序员来说，编写一个看起来像这样的 equals 方法并不少见，然后花上几个小时 苦苦思索为什么它不能正常工作</span></span></summary><div class="Toggle__Content"></div></details><div id="https://www.notion.so/6d3bd92e739d477786d701d06d1d74b1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/b86b42a096374309b17e86fdcb3aa892" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">比如这里将</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Object</code></span><span class="SemanticString">换成了</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">MyClass</code></span><span class="SemanticString">，这样是不会生效的：</span></span></p></div><pre id="https://www.notion.so/2504ecab2d974a3caeee0077327c2f60" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">MyClass</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/319725e2345f40d58c3c1de604a28b64" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">当然，你可以加 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">@Override</code></span><span class="SemanticString">来在编译时候报错提示，但是不借助IDE赋能特性也能做对事情，是我们本该追求的工匠精神。</span></span></p></div><h2 id="https://www.notion.so/14786e89d2cb44a78b5624c639e4b5be" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/14786e89d2cb44a78b5624c639e4b5be"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">12、始终重写 toString 方法</strong></mark></span></span></h2><div id="https://www.notion.so/043e60c5bd56402eb3c300fcedcef396" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对一个类，除非父类已经重写了</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">toString</code></span><span class="SemanticString">方法，否则在每个实例化的类中重写 Object 的 toString 实现。 其特点和要求是：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/cb75354657e748aeadd6ceeb3951cc5c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">它使得类更加舒适地使用和协助调试</span></span></li><li id="https://www.notion.so/7ca040a7e8a24065a9715b44108d3950" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">toString 方法应该以一种美观的格式返回对象的简明有用的描述，通常IDE工具都有自动生成方法</span></span></li></ul><h2 id="https://www.notion.so/8b04c8eb50464b7ebfb3f538c816a646" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8b04c8eb50464b7ebfb3f538c816a646"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">13、谨慎地重写 clone 方法</strong></mark></span></span></h2><h2 id="https://www.notion.so/65e4fa1b2fe34c318580daf678799b65" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/65e4fa1b2fe34c318580daf678799b65"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">14、考虑实现 Comparable 接口</strong></mark></span></span></h2><h2 id="https://www.notion.so/d9c46c3d1ce849beb647e4442d84488f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d9c46c3d1ce849beb647e4442d84488f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">15、使类和成员的可访问性最小化</strong></mark></span></span></h2><div id="https://www.notion.so/857d14a227884953917e59d03cf59e6f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用尽可能低的访问级别，与你正在编写的 软件的对应功能保持一致。按照可访问性从小到大列出：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/449ab45775fd4cefaccf4ede8e0e40b6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">private —— 该成员只能在声明它的顶级类内访问</span></span></li><li id="https://www.notion.so/8ff7b6cf91274785825b2c653d3cb09e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">package-private —— 成员可以从被声明的包中的任何类中访问。从技术上讲，如果没有指定访问修饰符 (接口成 员除外，它默认是公共的)，这是默认访问级别</span></span></li><li id="https://www.notion.so/788d2e750492461faa90490f42c98f45" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">protected —— 成员可以从被声明的类的子类中访问（受一些限制，JLS，6.6.2），以及它声明的包中的任何类</span></span></li><li id="https://www.notion.so/bd9f2a9e6e3b4599be2f0091366edf10" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">public —— 该成员可以从任何地方被访问</span></span></li></ul><h2 id="https://www.notion.so/faffba8123224697aa21ab1645541369" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/faffba8123224697aa21ab1645541369"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">16、在公共类中使用访问方法而不是公共属性</strong></mark></span></span></h2><h2 id="https://www.notion.so/c753a53e01584049ad13db2687ae058b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/c753a53e01584049ad13db2687ae058b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">17、最小化可变性</strong></mark></span></span></h2><div id="https://www.notion.so/2e384621f0754bdd87af1797cc01c00a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">要使一个类不可变，请遵循以下五条规则：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/1effb474a00e45c8b1a93daff71bc71f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">不要提供修改对象状态的方法（也称为 mutators）</span></span></li><li id="https://www.notion.so/ebd0de45e822414aa1f7dd71ccb43152" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">确保这个类不能被继承</strong></span><span class="SemanticString">。 这可以防止粗心的或恶意的子类，假设对象的状态已经改变，从而破坏类的不可变 行为。 防止子类化通常是通过 final 修饰类，但是我们稍后将讨论另一种方法</span></span></li><li id="https://www.notion.so/1434a8b490f44d9c9212865411b1ddc8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">把所有属性设置为 final</strong></span><span class="SemanticString">。 通过系统强制执行，清楚地表达了你的意图。 另外，如果一个新创建的实例的引用 从一个线程传递到另一个线程而没有同步，就必须保证正确的行为</span></span></li><li id="https://www.notion.so/cf8cdd8923404d198adf1124d9516dd3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">把所有的属性设置为 private</strong></span><span class="SemanticString">。 这可以防止客户端获得对属性引用的可变对象的访问权限并直接修改这些对 象。 虽然技术上允许不可变类具有包含基本类型数值的公共 final 属性或对不可变对象的引用，但不建议这 样做，因为它不允许在以后的版本中更改内部表示（条目 15 和 16）</span></span></li><li id="https://www.notion.so/aa09539ac0604e438261762004fff5b7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">确保对任何可变组件的互斥访问。 如果你的类有任何引用可变对象的属性，请确保该类的客户端无法获得对 这些对象的引用。 切勿将这样的属性初始化为客户端提供的对象引用，或从访问方法返回属性。 在构造方法， 访问方法和 readObject 方法（条目 88）中进行防御性拷贝（条目 50）</span></span></li></ul><h2 id="https://www.notion.so/aaaf4c9d8f894d3590922986c4981027" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/aaaf4c9d8f894d3590922986c4981027"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">18、 组合优于继承</strong></mark></span></span></h2><div id="https://www.notion.so/7c1de83162b84b75b797056a8ac9c8aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">继承是实现代码重用的有效方式，但并不总是最好的工具。与方法调用不同，继承打破了封装。</span></span></p></div><h2 id="https://www.notion.so/03e2efb5ec284e6ab0f4c46d3f2b21fc" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/03e2efb5ec284e6ab0f4c46d3f2b21fc"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">19、要么设计继承并提供文档说明，要么禁用继承</strong></mark></span></span></h2><h2 id="https://www.notion.so/adc2fbbe5f0f46fab537fb264f3218cd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/adc2fbbe5f0f46fab537fb264f3218cd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">20、接口优于抽象类</strong></mark></span></span></h2></article>
  <footer class="Footer">
  <div>&copy; 锡安的自留地 2024</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>

</body>

</html>