<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🦜&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>0014 一种加减密通信方案&nbsp;|&nbsp;李正的自留地</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="0014 一种加减密通信方案">
  
    <meta name="description" content="本文介绍了业界常用的RSA非对称加减密、3 DES对称加减密、加签验签方法。">
    <meta property="og:description" content="本文介绍了业界常用的RSA非对称加减密、3 DES对称加减密、加签验签方法。">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🍇&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🦜&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="e48d9ceebf4c4de2b657c3a3d1d308f4.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;☀️&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>工具</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🎏&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>关于我</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/nasa_space_shuttle_columbia_and_sunrise.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🍇&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">0014 一种加减密通信方案</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Jul 1, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/密码学.html">密码学</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--default">
            <a href="tag/信息安全.html">信息安全</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/0c8c349214be4593965da5900b03c41c" class="PageRoot"><h2 id="https://www.notion.so/938bb94956354634b440b9c0b401a6fd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/938bb94956354634b440b9c0b401a6fd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">概述</span></span></h2><div id="https://www.notion.so/4b0bb07f7e03418f8fba07af4cd78cb1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ea00aa5faf7143cdbe377c0dde426152" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">本文介绍了业界常用的RSA非对称加减密、3 DES对称加减密、加签验签方法。</span></span></p></div><h2 id="https://www.notion.so/b4bb215902384a4d86d1f83113442b06" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/b4bb215902384a4d86d1f83113442b06"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">业界典型的加密通信方式</span></span></h2><div id="https://www.notion.so/6ba5d321116c431f9a28337738d3c92d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在业界比较常见的做法是：对报文进行对称加密，对称加密的密钥，用对方的RSA公钥加密。为了报文的完整性，还需要对报文进行加签。</span></span></p></div><div id="https://www.notion.so/79cb4c3c35384e9eba8baa5f97281957" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/4bc26d306a3b45359b6c525bc935d89d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其中，RSA公私钥对的生成，是在企业内部自主完成。企业自主生成的RSA公钥，需要发送给报文接收方。公钥用来加密报文，私钥用来解密报文。比如企业A将公钥发给企业B，企业A保管自己的私钥，企业B用公钥对报文加密，发送给企业A，企业A用私钥进行解密。如果企业B向企业A发送消息，那么企业A向企业B提供公钥，因此我们总结为：</span></span></p></div><blockquote id="https://www.notion.so/45372c11a91c4c0a8746b5d7989ddd67" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">△ 非对称加密如RSA，生成时会有一把公钥，一把私钥，私钥自己保存，公钥发给对方
△ 公钥用于加密，私钥用于解密
△ A要发消息给B，需要B的公钥；B要发消息给A，需要A的公钥</span></span></blockquote><div id="https://www.notion.so/aca3385883aa4d728a2f0ef51c064708" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F71fe5748-2b2b-4d31-9940-7e9826cc0ed7%2FUntitled.png?width=948&amp;table=block&amp;id=aca33858-83aa-4d72-8a2f-0ef51c064708"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F71fe5748-2b2b-4d31-9940-7e9826cc0ed7%2FUntitled.png?width=948&amp;table=block&amp;id=aca33858-83aa-4d72-8a2f-0ef51c064708" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/c009fe6771c2457282eb5db419c85159" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/be23079f7a214626bf25c31473dceec7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/be23079f7a214626bf25c31473dceec7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">实践案例</span></span></h2><div id="https://www.notion.so/ee02444cba2e41bba9304d9e95514ed3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">本案例中，我们使用到的算法：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/a1ccb7d6809443299b4f3de232974fbc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对称加密密钥算法：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">3 DES</em></strong></code></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">，</em></span><span class="SemanticString">用于对报文加密，其优点是安全性高，速度快</span></span></li><li id="https://www.notion.so/0bd8a97319764358a1e27424fc7658cc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">非对称加密算法：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">RSA/ECB/PKCS1Padding</em></strong></code></span><span class="SemanticString">，用于对密钥加密</span></span></li><li id="https://www.notion.so/842c7ef72e7e41fbb319d1130b76142c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">签名算法：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">SHA256withRSA</strong></em></code></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">，</strong></em></span><span class="SemanticString">加签用自己的私钥，验签用对方公钥</span></span></li></ul><div id="https://www.notion.so/77a05ba437634b9da7f16aaa8711110a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0ec06f4c811d41509d6053b8bbf0a1cd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">具体流程如图：</span></span></p></div><div id="https://www.notion.so/4320e74d4f3a425f8c106ecfc71709f5" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc8b1acc2-5562-41db-8810-821e243d95f1%2FUntitled.png?width=2010&amp;table=block&amp;id=4320e74d-4f3a-425f-8c10-6ecfc71709f5"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc8b1acc2-5562-41db-8810-821e243d95f1%2FUntitled.png?width=2010&amp;table=block&amp;id=4320e74d-4f3a-425f-8c10-6ecfc71709f5" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/612e3b7673e648648dd00be440b5c78e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fee4bfa05cf3446691c4c1916a12e5b0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在两个企业已经互发了RSA公钥的前提下，消息发送方（企业A）加密流程为：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/209f7c17897247cc99d8a75ddd42513d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">企业A实时生成对称加密密钥K，加密算法为3 DES</span></span></li><li id="https://www.notion.so/16e4df8e8ad248798e65fa3640cc0dd8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用企业B的公钥对K进行加密，得到加密后的解密密钥encrypted_key</span></span></li><li id="https://www.notion.so/4573e043ec024e6fb4bbe1b4e1e0164d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用K对明文C进行加密，得到encrypted_data</span></span></li><li id="https://www.notion.so/4f06e51edf9d4080b6eccaaada1cda4f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用企业A的私钥对报文进行签名（加签），签名算法为SHA256withRSA，得到签名串sign</span></span></li><li id="https://www.notion.so/63b55aaf27cc402c80df68f262e7b416" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">打包报文[</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">encrypted_key， encrypted_data，sign</strong></span><span class="SemanticString">]，发送给接收方企业B</span></span></li></ul><div id="https://www.notion.so/9f7aacf9da534085abe3f6e81bd02437" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fa580faa1cb740859c19cfe4aa45497c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">消息接受方（企业B）解密流程为：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/e1f03f14ccde491c9ede31b28b107a2e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用企业B的RSA私钥对encrypted_key进行解密，得到解密密钥K</span></span></li><li id="https://www.notion.so/18808d770f4b4284bbf2220b87696961" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用解密密钥K对encrypted_data解密，得到明文的C</span></span></li><li id="https://www.notion.so/e8e60da4e20046d6973850f673774ade" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用企业A的公钥对报文进行签名串sign验签，验签算法为SHA256withRSA</span></span></li></ul><div id="https://www.notion.so/1726516128ef48e2a7386323fe549277" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h3 id="https://www.notion.so/3c31d4cae259480bba74d992aa30672a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3c31d4cae259480bba74d992aa30672a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">算法选型解惑</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/4a3c174e9c01492eb4f172b3eb605fde" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">RSA为什么不用来加密报文体，而是用来加密解密密钥？</strong></span></span></li></ul><ol class="NumberedListWrapper"><li id="https://www.notion.so/67351606684b4de1b4601e20775acc5d" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">密钥长度：RSA的安全性取决于密钥的长度。较长的密钥长度提供更高的安全性，但也导致更慢的性能。常用的RSA密钥长度为2048位或4096位。</span></span></li><li id="https://www.notion.so/962dc9da7e4b495f9c41d2af5631e0f4" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">加密速度：RSA的加密速度比对称加密算法（如AES）慢得多。这是因为RSA算法涉及大数的运算，包括模幂运算和大素数计算，这些运算需要较长的时间。因此，对大量数据进行RSA加密可能会显著降低性能。</span></span></li><li id="https://www.notion.so/722240b486e843019d4115ac78680e2d" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">加密限制：RSA加密的数据长度有限制。加密的数据块不能超过密钥长度，且通常要小于密钥长度减去一些填充的字节数。对于较长的数据，通常使用对称加密算法加密数据本身，然后使用RSA加密对称密钥。</span></span></li></ol><div id="https://www.notion.so/df49dd7255e6438192e23a3d5009ed02" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">基于以上原因，我们不用RSA算法来直接加密报文体本身。</span></span></p></div><div id="https://www.notion.so/c50112dd798f4b90b637e7dfd9e8cadc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/f309dde19eff45749f75965973645d55" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">为什么用3 DES来加密报文体？</strong></span></span></li></ul><ol class="NumberedListWrapper"><li id="https://www.notion.so/d9e6cdc0ac2344618b726e428e988456" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">兼容性：3DES是DES算法的增强版本，它使用相同的加密算法结构，只是增加了迭代次数。这意味着3DES可以与使用DES加密的旧系统兼容，同时提供更高的安全性。</span></span></li><li id="https://www.notion.so/a2352c011e3d49b286b364ae2a957d19" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">安全性：DES算法的密钥长度较短（56位），已被认为不够安全。3DES通过使用三个不同的密钥对数据进行三次加密，有效地扩展了密钥长度，提供更高的安全性。它提供的密钥空间更大（168位），使得暴力破解变得非常困难。</span></span></li><li id="https://www.notion.so/a7ecc84cc8ce4548aab54252247630e9" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">抗击穷举攻击：3DES的安全性基于DES算法的困难性。对于穷举攻击（exhaustive search attack），即尝试所有可能的密钥进行解密的攻击，3DES提供了更大的密钥空间，使得攻击者需要更多的时间和计算资源来尝试所有可能的密钥。</span></span></li><li id="https://www.notion.so/7f1b47f7a6974f748d6049b8755ee93b" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">广泛应用：由于3DES的兼容性和安全性，它被广泛应用于各种领域，如金融机构、电子支付、通信和网络安全等。许多安全标准和协议（如TLS、IPsec）也使用3DES作为加密算法之一。</span></span></li></ol><div id="https://www.notion.so/d9631b20f9a34696973e145bc69dff2b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/e27d4e43b5db4cf1b229944b450eeed8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/e27d4e43b5db4cf1b229944b450eeed8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">最佳实践（Java）</span></span></h2><h3 id="https://www.notion.so/1187fce1770c490a86ab7a114a89d7b0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1187fce1770c490a86ab7a114a89d7b0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">生成企业A和企业B自己的RSA公私钥对(Base 64编码)</span></span></h3><div id="https://www.notion.so/2c918f66c1c5477f98342a0b4aac1002" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">生成方法：</span></span></p></div><pre id="https://www.notion.so/ae9abef6a3114930a01e7e48a967cc5e" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RSAKeyPairGenerator</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 创建RSA密钥对生成器</span>
            <span class="token class-name">KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置密钥长度，一般推荐使用2048位或以上</span>
            keyPairGenerator<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 生成密钥对</span>
            <span class="token class-name">KeyPair</span> keyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取公钥和私钥的字节数组</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> publicKeyBytes <span class="token operator">=</span> keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> privateKeyBytes <span class="token operator">=</span> keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 将字节数组转Base 64编码</span>
            <span class="token class-name">String</span> publicKeyBase64 <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>publicKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> privateKeyBase64 <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>privateKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 输出公钥和私钥</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"公钥："</span> <span class="token operator">+</span> publicKeyBase64<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> <span class="token string">"私钥："</span> <span class="token operator">+</span> privateKeyBase64<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchAlgorithmException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/7b381440748049409ff8bbb6b3b76697" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">通过以上方法，我们得到企业A和企业B的公私钥信息。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/044ff1c1a6ff4e2db5c6ed484b1c08ff" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">企业A公钥：</span></span></li></ul><pre id="https://www.notion.so/445c2ed5b5724da490ea501cfcddd5fc" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtLmnzL7sqrv5LsUt2LYs5nEKdlt</span><span class="token operator">+</span><span class="token class-name">BIgbTT4SYutPgCNFR83AE95w7</span><span class="token operator">/</span>cQHCG1T79Agp3WbwpJOT6tCLUBQ48V2rRA235ZOtlswMKM1WE9TM6AuyXCGJLIFuK9pShCx7<span class="token operator">+</span><span class="token number">6</span>jksSNtuGxf2YfTFxKnP7VfjxEZKn26aCiSqzXBptxesVfPgHIB4OSRZFT360jBP<span class="token operator">/</span><span class="token number">38</span>ci37Q3vHND2z5plPMfdNRqgGawMb0lNsnCFi28l5jetpzQ25mfTUxaP0dT<span class="token operator">+</span>m4<span class="token operator">+</span>uXHm6vAwrYal0i<span class="token operator">/</span>p0UWwHgzVZUvKirZfHURYzZ4BWC9grbSAA7XMLaxhdR<span class="token operator">/</span><span class="token class-name">J3pEGT6rA0onrhQUjafWTsVpVYwIDAQAB</span></span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/9ce227c52818485fb7138d6b6af26e6b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">企业A私钥：</span></span></li></ul><pre id="https://www.notion.so/d1e22b0a71884c4bb3fd1ca32db17854" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC0uafMvuyqu</span><span class="token operator">/</span>kuxS3YtizmcQp2W34EiBtNPhJi60<span class="token operator">+</span><span class="token class-name">AI0VHzcAT3nDv9xAcIbVPv0CCndZvCkk5Pq0ItQFDjxXatEDbflk62WzAwozVYT1MzoC7JcIYksgW4r2lKELHv7qOSxI224bF</span><span class="token operator">/</span><span class="token class-name">Zh9MXEqc</span><span class="token operator">/</span>tV<span class="token operator">+</span><span class="token class-name">PERkqfbpoKJKrNcGm3F6xV8</span><span class="token operator">+</span><span class="token class-name">AcgHg5JFkVPfrSME</span><span class="token comment">//fxyLftDe8c0PbPmmU8x901GqAZrAxvSU2ycIWLbyXmN62nNDbmZ9NTFo/R1P6bj65cebq8DCthqXSL+nRRbAeDNVlS8qKtl8dRFjNngFYL2CttIADtcwtrGF1H8nekQZPqsDSieuFBSNp9ZOxWlVjAgMBAAECggEATxA1n7YbFap8ngB3SSqRxBLKD/OA0vy0bPtt0ca+FgHYKkyR7l9PKzv72ULJ7mRuFXZ1vEhUtm18B6YgMm0jk3VuNlg1MzCxijbSo/sRdUuWN8mR+2wjixeQ/fL6HCb9t4iSJFuvv2htUL/TkU4CM59f3184fjh/PQDoTK/nPEEaA15g+6VuAt76r04LA4XhYOQtXnR+sHVIc/b/FqgEFXLaIPvQqXDCZmZhewOd2Hzgxl6a5cDQ1ZLLmnczMiLi2Yu2BGdHl4XVwjmC7bWO/hliaAvLyYq83eap+AJtXiL99fHWD4qETcp2hSC+4v03Zgh2qUT9APw16UVGQhyauQKBgQDunRVL4FoY+VqqXo5EuCh9nQNzTYAh5587t2P4VS1mr+8v5qqeD6IWt/eiOt0078nhAS3f3zZ974w8pwam7Y4pb47OjmLj/F655E6t9HRrcPhGffuj8X4VtUAznUckYHnJFWc0ivMyTS14lJXiAWsKHJqBLLvEM5fKLDY5IYxpPwKBgQDB5MQqLCCNx0ONK5hwmX2DyigyKMgG0oQTDtAVmy0oAEFViBCc11Tazf7C0HA1+SBZQ2YylUwCGkvJ3cQII8b1GJzNTefrOeFPOg8CxztkBP/o/f2a0FeULhSzWTZSrArzkB/4xN+sxtF/wtItDBYrLA43L3uc0EBGyjJ4GFQG3QKBgAv06yBGOb2OoTBwVIi1AbJpr8aTV5xbUutXITdMbV376uxnjp0lA2ZICayjbno8mc0glf/l24EsA8b2R6sNtFX3NRy8nc/20XhXLGojGcJYgthlb7qjW0ITNwhfFTWJcBDXdbh4Tf9zRpgIOgp9L7PuAv/+EdqfCzgiRwVN3Q9ZAoGALnCtr3AsR+kPO/PSKj4JOxSjdgggiMnJSotEubgWI7uT6nmRiQ9mSpYGTAECr1rBLcAf7UOnFeXYezw7pLt0/uVrQR1EzClr1r8QM1km13j/Fn4nTPpTz7EN0jsu8LQ2V0oQ7lOxQz/Hk/NExfdcI/EEYqFj2RZkHtB1MCCbl50CgYEAvJ7dmIRShffxkllybCbM3DEYidbszorGp69tUyX2Hb4EYH7qsH1RXtRivltzsR+b9f9lrfTwrSdD7rMpwRHAYHbDSKQgL/sVDNh8DnFn/dDFoLpfPQdR9PfNTUPtqe8NIjIUhkxzLOqHZgm+zGfOMlfgJiRodKJ63lidHEXHBwE=</span></span></span></span></code></pre><div id="https://www.notion.so/f9aabbc197734844ba6571f5d0045baa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/396f5714c7fc49568bed6632d89c8c9c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">企业B公钥：</span></span></li></ul><pre id="https://www.notion.so/4e439180c1a445baab1397a12aff7a6f" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApAkZ0gbyKfDDYtMs8ITRITYOF8OyRDHyeJmUQyDjXlMqO3c911025N02JEkk68UI7n6cYARiBYPznrKTckzbzOxlrwTyOveQpxeR</span><span class="token operator">/</span><span class="token class-name">KsqQglXTGglmEUHyOfKRTajkhtwv3bpt5OPRaFdwOZjGYUJ6dOqdnlH9LASIjA0jNDFoT4RANgYbdS</span><span class="token operator">+</span>s<span class="token operator">+</span><span class="token constant">Y5</span><span class="token operator">/</span>uS<span class="token operator">+</span>lZD7RnRjwdcHJWpyO3Jp7OKukRN<span class="token operator">+</span><span class="token class-name">EaedBFuuE2iF8XWcKXVGUXZyxqOU0S266WYJdcmZaRkKMZ4Pruy5IjwEXDR7sMVv</span><span class="token operator">+</span><span class="token number">51</span>wVv85ue<span class="token operator">+</span>kGDeqlVfHajLh6G5mWvqNuFASyx2obYUNeE3f53ziC6qjHuTcXQIDAQAB</span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/c3e1cf29f6104dab89d6b44a5bd13b03" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">企业B的私钥：</span></span></li></ul><pre id="https://www.notion.so/b929c86b9c304e8d94cf3ea6125e33c0" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCkCRnSBvIp8MNi0yzwhNEhNg4Xw7JEMfJ4mZRDIONeUyo7dz3XXTbk3TYkSSTrxQjufpxgBGIFg</span><span class="token operator">/</span><span class="token class-name">OespNyTNvM7GWvBPI695CnF5H8qypCCVdMaCWYRQfI58pFNqOSG3C</span><span class="token operator">/</span>dum3k49FoV3A5mMZhQnp06p2eUf0sBIiMDSM0MWhPhEA2Bht1L6z5jn<span class="token operator">+</span><span class="token number">5L</span><span class="token number">6</span>VkPtGdGPB1wclanI7cmns4q6RE34Rp50EW64TaIXxdZwpdUZRdnLGo5TRLbrpZgl1yZlpGQoxng<span class="token operator">+</span>u7LkiPARcNHuwxW<span class="token operator">/</span><span class="token number">7</span>nXBW<span class="token operator">/</span>zm576QYN6qVV8dqMuHobmZa<span class="token operator">+</span>o24UBLLHahthQ14Td<span class="token operator">/</span>nfOILqqMe5NxdAgMBAAECggEAFM<span class="token operator">/</span>eycn90Zptf81hR0birb8I<span class="token operator">/</span><span class="token class-name">LTkmkhoBiseJ4I1ttMAabkQTJHUFCeI5gOtvogqQPApcPk9YovCTiFEGd1sicx4fkM3ZInifYC9Efy5iNVckSIpmu8vNKtL</span><span class="token operator">+</span><span class="token number">4</span>oaKMB4hqJUtuju5Zu6pG3Wpvc9McCcQRnUKlRoiJPrJu6aFIHx4rqSjoI3cmC7k<span class="token operator">/</span><span class="token number">4</span>Z5M12HQAtAdj97<span class="token operator">+</span><span class="token number">0</span><span class="token operator">+</span><span class="token class-name">LGzytnWf3JgopH4k</span><span class="token operator">/</span><span class="token class-name">HFT0XTb13JTBdaRsjWFLJwKqXcBYNeDOUAoK</span><span class="token operator">+</span>bcRd7V5eYqoyIfIBwIT2xNJU4ivK0copoIqKAbcu2vY<span class="token operator">/</span><span class="token class-name">KcSrnCx</span><span class="token operator">+</span><span class="token class-name">G7yflJ38Qiv</span><span class="token operator">/</span><span class="token number">1</span>HhXNpUPbElt2hsN9roQKBgQDtFBKv8Ao9ax9ls9ukcfhlCrGgtTTUMoXEEz<span class="token operator">/</span>d2WKVzX9Sc5lkczsqAMNZ<span class="token operator">++</span>x630c61<span class="token operator">/</span><span class="token class-name">JNNPkzDBNrY8PWMvGvTukwNRJnqUYdWhIMtJUJkf</span><span class="token operator">+</span><span class="token class-name">Y6I7CTShDy9eezxMUe9X8sY3J25s8Xz1Qv6yt91</span><span class="token operator">+</span><span class="token class-name">ZweUvoYy2WFbdQH50KnN7uQKBgQCxIKJky1oxV02OyGm</span><span class="token operator">/</span>kIMZf4QEKii3nZsQUYqoS8Uc6eDLM3G2URQxWlQ4ugSTC6G6imGXU2AVL2xNniy<span class="token operator">+</span><span class="token class-name">NqPHICikTQ1XZaz</span><span class="token operator">+</span><span class="token number">8</span>KBeeotznWJJL5bCpCcHrC<span class="token comment">//C9oMA/t0huRTFzLeEmIV+OHWCCxyO+z5XxWujPXB31Tt4oVfxQKBgDdY7FPusjVMgPP5XVmy0c6lBHsEUuUHNntkExDz4zQd2Y+iNTliPXm8295yFe9JmRN/vq2PpG3qb84uaFXlZs8KmR4MBdP1jMzlbjlRH0owr38/K7To1nGdcSU+KrIphveLbBKoFkGt6l6joOisS8FVpu/Lw1H+pajZmav9DSDhAoGBAK2YVFAA1MZiz8pONQXgNfx5cwM55mn+dwjJQeGrUOYDeaLtKlcKo4WzB7QI647J6ZmPIhJTTmm07qoriaJqnpz7sZlFQvwS1DeP0TyHUcDf0IH1uAXPJ8lnQirujKcWCA2uXnvo0pu+3I64O22u2RCkFp5YSEGoOPvnS69RQHIZAoGBAM5MotoO3IWn5Kw54hhQkfmLCZmN2xeztSwmweIMNsn9Fjk2j1kZnqqusxAC3errKnQb+Xmo3P/pJmYW9N5m7HT9kcuK7vJAdq6eIcVkCKo17RLKUhYhQd3HgqrjUQRsjYWkUKdW7UDM8NoyG5JXYOaQ+BFjcParOKXS4QKiRgAh</span></span></span></span></code></pre><div id="https://www.notion.so/ee686abbd35149468f59a0ca0c31d294" class="Divider"></div><h2 id="https://www.notion.so/7b1c77cd175b49bf9292666c4bbd19f5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7b1c77cd175b49bf9292666c4bbd19f5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">企业A加密过程</span></span></h2><div id="https://www.notion.so/1c33dc9542214970832d4c54c1e5f9ac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在上面RSA公私钥对的基础上，我们来模拟企业A加密的流程，假设我们要发给企业B的原报文内容为：</span></span></p></div><blockquote id="https://www.notion.so/6b87e6e8d4164ed586144cfcef0ac97c" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">Hello, World!</mark></strong></em></span></span></blockquote><div id="https://www.notion.so/cb66ef8d21884fdea4eddfa7061bc72b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注：本文所有加减密信息输出均为Base64编码。</span></span></p></div><div id="https://www.notion.so/7def26faf442492ba7ec512a19171376" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">企业A生成 3 DES的加密串：</span></span></p></div><pre id="https://www.notion.so/6b94462c5cdb45e6935cabedaac66f43" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// 生成3DES密钥</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateTripleDESKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span> <span class="token punctuation">{</span>
        <span class="token class-name">KeyGenerator</span> keyGenerator <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DESede"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyBytes <span class="token operator">=</span> keyGenerator<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将SecretKey转换为Base 64字符串</span>
        <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/c861e18c1db54192a507c6045827b88e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">3 DES密钥串：</span></span></p></div><pre id="https://www.notion.so/68111ba5d3e647209bdcc8b27974df35" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>lLkL6UwL<span class="token operator">+</span><span class="token operator">/</span>uoy1RUhdPsV67NIP4a1eA7</span></span></span></code></pre><div id="https://www.notion.so/9302b69f0d4c49d4a6f8c8d575b887ae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/b93741ee0cb64b6a8840c8b962a15226" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对报文加密：</span></span></p></div><pre id="https://www.notion.so/61f25d11b6ff48238416a7f227607a14" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// 待加密的报文</span>
<span class="token class-name">String</span> plaintext <span class="token operator">=</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> encryptedText <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Encrypted Text: "</span> <span class="token operator">+</span> encryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 加密方法</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> plaintext<span class="token punctuation">,</span> <span class="token class-name">SecretKey</span> secretKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
	<span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DESede/ECB/PKCS5Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encryptedBytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encryptedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/2df224a98df24ecc89bc42b1790cf85e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/11e74b366906400085c1ccf3d48eb77e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">加密后的字符串 </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">encrypted_data</strong></em></span><span class="SemanticString">：</span></span></p></div><pre id="https://www.notion.so/ce3c25c8613047c2996514e1133c874a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">KiKj8YAQeyX6U9CP0xuJTA</span><span class="token operator">==</span></span></span></span></code></pre><div id="https://www.notion.so/a0d4480845164f67b38fdc124cf2297f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/08835dc01cf847f188f315155da80c87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对3 DES密钥串使用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">企业B的公钥</strong></span><span class="SemanticString">加密：</span></span></p></div><pre id="https://www.notion.so/fbce902302704dea829da6bfa4e7049e" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">package</span> <span class="token namespace">encrypt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">KeyFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">NoSuchAlgorithmException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">PrivateKey</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">PublicKey</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">InvalidKeySpecException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">PKCS8EncodedKeySpec</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">X509EncodedKeySpec</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RsaEncrypt</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> desKey <span class="token operator">=</span> <span class="token string">"lLkL6UwL+/uoy1RUhdPsV67NIP4a1eA7"</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> publicKeyStrOfEntB <span class="token operator">=</span> <span class="token string">"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApAkZ0gbyKfDDYtMs8ITRITYOF8OyRDHyeJmUQyDjXlMqO3c911025N02JEkk68UI7n6cYARiBYPznrKTckzbzOxlrwTyOveQpxeR/KsqQglXTGglmEUHyOfKRTajkhtwv3bpt5OPRaFdwOZjGYUJ6dOqdnlH9LASIjA0jNDFoT4RANgYbdS+s+Y5/uS+lZD7RnRjwdcHJWpyO3Jp7OKukRN+EaedBFuuE2iF8XWcKXVGUXZyxqOU0S266WYJdcmZaRkKMZ4Pruy5IjwEXDR7sMVv+51wVv85ue+kGDeqlVfHajLh6G5mWvqNuFASyx2obYUNeE3f53ziC6qjHuTcXQIDAQAB"</span><span class="token punctuation">;</span>
        <span class="token class-name">PublicKey</span> publicKey <span class="token operator">=</span> <span class="token function">convertStringToPublicKey</span><span class="token punctuation">(</span>publicKeyStrOfEntB<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> encryptedText <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>desKey<span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"encrypted_key: "</span> <span class="token operator">+</span> encryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">// 加密</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> plaintext<span class="token punctuation">,</span> <span class="token class-name">PublicKey</span> publicKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA/ECB/PKCS1Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encryptedBytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encryptedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将字符串转换为公钥对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PublicKey</span> <span class="token function">convertStringToPublicKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> publicKeyString<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidKeySpecException</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> publicKeyBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>publicKeyString<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>publicKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/e0e70373cbc7417a99cfb388de0c59cc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">得到 </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">encrypted_key</strong></em></span><span class="SemanticString">：</span></span></p></div><pre id="https://www.notion.so/33fd8ab87cb545c49a799498141f37f6" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">DmB1O9</span><span class="token operator">/</span><span class="token number">0</span>KfG53qvgQ<span class="token operator">/</span>jiCYhDwFISu<span class="token operator">+</span><span class="token class-name">RiVqWQF3o1IhRcxYe</span><span class="token operator">+</span>e8GJMIVh8<span class="token operator">/</span><span class="token number">6</span>Wrc4jzywlg6Eylsc0jTvvEbprH4USQc<span class="token operator">/</span><span class="token class-name">I4aYVPaY0kSlRcpIEgy69S9D4Zlc5XsLiOiXrZP2O</span><span class="token operator">/</span><span class="token number">9F</span>sdphFIeKuzN4dT8tnudfNXrS9A21s2bpF0bt4eDvLNUxbl3mnI74VAmH5o723tEmqFq5XeO<span class="token operator">/</span>gBudxeHlIwTO09<span class="token operator">/</span><span class="token class-name">TjTpM3wGwQwycVr</span><span class="token operator">/</span><span class="token class-name">CZRgY4SWoCkiZhRH7ikfpoqPODoYL0ZL083U2ClR0BZ71jZh3aPqTsjTIk</span><span class="token operator">/</span>ctAEW<span class="token operator">+</span>eC92a7<span class="token operator">/</span>d7CWpx<span class="token operator">+</span><span class="token class-name">DKvIngNvPSgXXPq4JCikmH8pQ</span><span class="token operator">==</span></span></span></span></code></pre><div id="https://www.notion.so/1518e73748d742448adb97f50a4ea813" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/21b6a3752d8143869d9d32cfefce51bf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">SHA246withRSA</code></span><span class="SemanticString">对明文报文加签：</span></span></p></div><pre id="https://www.notion.so/1a65facc7aa94dd49e7dc08c28d1945d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">package</span> <span class="token namespace">encrypt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RSASignatureExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 企业A的私钥</span>
            <span class="token class-name">String</span> privateKeyOfEntA <span class="token operator">=</span> <span class="token string">"MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC0uafMvuyqu/kuxS3YtizmcQp2W34EiBtNPhJi60+AI0VHzcAT3nDv9xAcIbVPv0CCndZvCkk5Pq0ItQFDjxXatEDbflk62WzAwozVYT1MzoC7JcIYksgW4r2lKELHv7qOSxI224bF/Zh9MXEqc/tV+PERkqfbpoKJKrNcGm3F6xV8+AcgHg5JFkVPfrSME//fxyLftDe8c0PbPmmU8x901GqAZrAxvSU2ycIWLbyXmN62nNDbmZ9NTFo/R1P6bj65cebq8DCthqXSL+nRRbAeDNVlS8qKtl8dRFjNngFYL2CttIADtcwtrGF1H8nekQZPqsDSieuFBSNp9ZOxWlVjAgMBAAECggEATxA1n7YbFap8ngB3SSqRxBLKD/OA0vy0bPtt0ca+FgHYKkyR7l9PKzv72ULJ7mRuFXZ1vEhUtm18B6YgMm0jk3VuNlg1MzCxijbSo/sRdUuWN8mR+2wjixeQ/fL6HCb9t4iSJFuvv2htUL/TkU4CM59f3184fjh/PQDoTK/nPEEaA15g+6VuAt76r04LA4XhYOQtXnR+sHVIc/b/FqgEFXLaIPvQqXDCZmZhewOd2Hzgxl6a5cDQ1ZLLmnczMiLi2Yu2BGdHl4XVwjmC7bWO/hliaAvLyYq83eap+AJtXiL99fHWD4qETcp2hSC+4v03Zgh2qUT9APw16UVGQhyauQKBgQDunRVL4FoY+VqqXo5EuCh9nQNzTYAh5587t2P4VS1mr+8v5qqeD6IWt/eiOt0078nhAS3f3zZ974w8pwam7Y4pb47OjmLj/F655E6t9HRrcPhGffuj8X4VtUAznUckYHnJFWc0ivMyTS14lJXiAWsKHJqBLLvEM5fKLDY5IYxpPwKBgQDB5MQqLCCNx0ONK5hwmX2DyigyKMgG0oQTDtAVmy0oAEFViBCc11Tazf7C0HA1+SBZQ2YylUwCGkvJ3cQII8b1GJzNTefrOeFPOg8CxztkBP/o/f2a0FeULhSzWTZSrArzkB/4xN+sxtF/wtItDBYrLA43L3uc0EBGyjJ4GFQG3QKBgAv06yBGOb2OoTBwVIi1AbJpr8aTV5xbUutXITdMbV376uxnjp0lA2ZICayjbno8mc0glf/l24EsA8b2R6sNtFX3NRy8nc/20XhXLGojGcJYgthlb7qjW0ITNwhfFTWJcBDXdbh4Tf9zRpgIOgp9L7PuAv/+EdqfCzgiRwVN3Q9ZAoGALnCtr3AsR+kPO/PSKj4JOxSjdgggiMnJSotEubgWI7uT6nmRiQ9mSpYGTAECr1rBLcAf7UOnFeXYezw7pLt0/uVrQR1EzClr1r8QM1km13j/Fn4nTPpTz7EN0jsu8LQ2V0oQ7lOxQz/Hk/NExfdcI/EEYqFj2RZkHtB1MCCbl50CgYEAvJ7dmIRShffxkllybCbM3DEYidbszorGp69tUyX2Hb4EYH7qsH1RXtRivltzsR+b9f9lrfTwrSdD7rMpwRHAYHbDSKQgL/sVDNh8DnFn/dDFoLpfPQdR9PfNTUPtqe8NIjIUhkxzLOqHZgm+zGfOMlfgJiRodKJ63lidHEXHBwE="</span><span class="token punctuation">;</span>
         
            <span class="token class-name">PrivateKey</span> privateKey <span class="token operator">=</span> <span class="token function">convertStringToPrivateKey</span><span class="token punctuation">(</span>privateKeyOfEntA<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
						<span class="token comment">// 需要签名的字符串</span>
            <span class="token class-name">String</span> plaintext  <span class="token operator">=</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">;</span>

            <span class="token comment">// 对字符串进行签名</span>
            <span class="token class-name">String</span> signature <span class="token operator">=</span> <span class="token function">sign</span><span class="token punctuation">(</span>plaintext <span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sign: "</span> <span class="token operator">+</span> signature<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 对字符串进行签名</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">sign</span><span class="token punctuation">(</span><span class="token class-name">String</span> data<span class="token punctuation">,</span> <span class="token class-name">PrivateKey</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Signature</span> signature <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"SHA256withRSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        signature<span class="token punctuation">.</span><span class="token function">initSign</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        signature<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> signatureBytes <span class="token operator">=</span> signature<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>signatureBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   <span class="token comment">// 将字符串转换为私钥对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PrivateKey</span> <span class="token function">convertStringToPrivateKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> privateKeyString<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidKeySpecException</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> privateKeyBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>privateKeyString<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PKCS8EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>privateKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/76f7665203e242b4bb1821d64948c1b6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">得到签名串 </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">sign </strong></em></span><span class="SemanticString">：</span></span></p></div><pre id="https://www.notion.so/cd8e467ebd994c05b8b631df113730a6" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">W2vPVeQtfIGLSYajA9PZzHuC0W7KPhfOXdC</span><span class="token operator">+</span>osyBLYpYEm40NGshnKd8S8t5XMq6Tf<span class="token operator">/</span><span class="token class-name">ZJ96fHeyS6XOIVjZCE0WZcl5J7s8uvkdjKKir35Itbj3hYidTVO1B93KdoAJRtjUd0NxaWN</span><span class="token operator">+</span>uscJB5VepkNqayS4<span class="token operator">+</span>wwyOf9HRQkcoRjNTzkHupUZlQ9bTedjIm3NK5U6qONbwqlEvgdYLWOW1DmXBdZ3UKbgTrlEmRYYHcI9xth1nbJr9YumENttHL0vzDFid1V3J5JqWN15jVfGPrUhSgZWeG8dQj3mP6uMQ5l2KRVLU7Ditvjy7MmINXmtHvKoeKyC5bO89y2em0TFfig<span class="token operator">==</span></span></span></span></code></pre><div id="https://www.notion.so/68fefb7d0eb04e8ea0d8ecc642ebfa88" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">因此我们得到企业A最终要发送的报文：</span></span></p></div><pre id="https://www.notion.so/21cef1f981eb462faba5962414b9a52a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>"</span></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>encrypted_key<span class="token string">":"</span></span></strong></em></span><span class="SemanticString"><span>DmB1O9/0KfG53qvgQ/jiCYhDwFISu+RiVqWQF3o1IhRcxYe+e8GJMIVh8/6Wrc4jzywlg6Eylsc0jTvvEbprH4USQc/I4aYVPaY0kSlRcpIEgy69S9D4Zlc5XsLiOiXrZP2O/9FsdphFIeKuzN4dT8tnudfNXrS9A21s2bpF0bt4eDvLNUxbl3mnI74VAmH5o723tEmqFq5XeO/gBudxeHlIwTO09/TjTpM3wGwQwycVr/CZRgY4SWoCkiZhRH7ikfpoqPODoYL0ZL083U2ClR0BZ71jZh3aPqTsjTIk/ctAEW+eC92a7/d7CWpx+DKvIngNvPSgXXPq4JCikmH8pQ==</span></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>"<span class="token punctuation">,</span>
<span class="token property">"encrypted_data"</span><span class="token operator">:</span>"</span></strong></em></span><span class="SemanticString"><span>KiKj8YAQeyX6U9CP0xuJTA==</span></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>"<span class="token punctuation">,</span>
<span class="token property">"sign"</span><span class="token operator">:</span>"</span></strong></em></span><span class="SemanticString"><span>W2vPVeQtfIGLSYajA9PZzHuC0W7KPhfOXdC+osyBLYpYEm40NGshnKd8S8t5XMq6Tf/ZJ96fHeyS6XOIVjZCE0WZcl5J7s8uvkdjKKir35Itbj3hYidTVO1B93KdoAJRtjUd0NxaWN+uscJB5VepkNqayS4+wwyOf9HRQkcoRjNTzkHupUZlQ9bTedjIm3NK5U6qONbwqlEvgdYLWOW1DmXBdZ3UKbgTrlEmRYYHcI9xth1nbJr9YumENttHL0vzDFid1V3J5JqWN15jVfGPrUhSgZWeG8dQj3mP6uMQ5l2KRVLU7Ditvjy7MmINXmtHvKoeKyC5bO89y2em0TFfig==</span></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>"</span></strong></em></span></span></code></pre><div id="https://www.notion.so/a312bf99649c4e1f861a357171786ffa" class="Divider"></div><h2 id="https://www.notion.so/f00b75d8998644788693df478accac17" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/f00b75d8998644788693df478accac17"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">企业B解密过程</span></span></h2><div id="https://www.notion.so/e4aa1d697ece432fbf51faabc7ea304d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">企业B接收到报文后，首先用企业B的私钥对</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">encrypted_key</strong></em></span><span class="SemanticString">进行解密：</span></span></p></div><pre id="https://www.notion.so/b550b757cad441ab88eebc0b35f7a51c" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">package</span> <span class="token namespace">encrypt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">KeyFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">PrivateKey</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">PKCS8EncodedKeySpec</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RsaDecode</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> encryptedKey <span class="token operator">=</span> <span class="token string">"DmB1O9/0KfG53qvgQ/jiCYhDwFISu+RiVqWQF3o1IhRcxYe+e8GJMIVh8/6Wrc4jzywlg6Eylsc0jTvvEbprH4USQc/I4aYVPaY0kSlRcpIEgy69S9D4Zlc5XsLiOiXrZP2O/9FsdphFIeKuzN4dT8tnudfNXrS9A21s2bpF0bt4eDvLNUxbl3mnI74VAmH5o723tEmqFq5XeO/gBudxeHlIwTO09/TjTpM3wGwQwycVr/CZRgY4SWoCkiZhRH7ikfpoqPODoYL0ZL083U2ClR0BZ71jZh3aPqTsjTIk/ctAEW+eC92a7/d7CWpx+DKvIngNvPSgXXPq4JCikmH8pQ=="</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> privateKeyStrOfEntB <span class="token operator">=</span> <span class="token string">"MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCkCRnSBvIp8MNi0yzwhNEhNg4Xw7JEMfJ4mZRDIONeUyo7dz3XXTbk3TYkSSTrxQjufpxgBGIFg/OespNyTNvM7GWvBPI695CnF5H8qypCCVdMaCWYRQfI58pFNqOSG3C/dum3k49FoV3A5mMZhQnp06p2eUf0sBIiMDSM0MWhPhEA2Bht1L6z5jn+5L6VkPtGdGPB1wclanI7cmns4q6RE34Rp50EW64TaIXxdZwpdUZRdnLGo5TRLbrpZgl1yZlpGQoxng+u7LkiPARcNHuwxW/7nXBW/zm576QYN6qVV8dqMuHobmZa+o24UBLLHahthQ14Td/nfOILqqMe5NxdAgMBAAECggEAFM/eycn90Zptf81hR0birb8I/LTkmkhoBiseJ4I1ttMAabkQTJHUFCeI5gOtvogqQPApcPk9YovCTiFEGd1sicx4fkM3ZInifYC9Efy5iNVckSIpmu8vNKtL+4oaKMB4hqJUtuju5Zu6pG3Wpvc9McCcQRnUKlRoiJPrJu6aFIHx4rqSjoI3cmC7k/4Z5M12HQAtAdj97+0+LGzytnWf3JgopH4k/HFT0XTb13JTBdaRsjWFLJwKqXcBYNeDOUAoK+bcRd7V5eYqoyIfIBwIT2xNJU4ivK0copoIqKAbcu2vY/KcSrnCx+G7yflJ38Qiv/1HhXNpUPbElt2hsN9roQKBgQDtFBKv8Ao9ax9ls9ukcfhlCrGgtTTUMoXEEz/d2WKVzX9Sc5lkczsqAMNZ++x630c61/JNNPkzDBNrY8PWMvGvTukwNRJnqUYdWhIMtJUJkf+Y6I7CTShDy9eezxMUe9X8sY3J25s8Xz1Qv6yt91+ZweUvoYy2WFbdQH50KnN7uQKBgQCxIKJky1oxV02OyGm/kIMZf4QEKii3nZsQUYqoS8Uc6eDLM3G2URQxWlQ4ugSTC6G6imGXU2AVL2xNniy+NqPHICikTQ1XZaz+8KBeeotznWJJL5bCpCcHrC//C9oMA/t0huRTFzLeEmIV+OHWCCxyO+z5XxWujPXB31Tt4oVfxQKBgDdY7FPusjVMgPP5XVmy0c6lBHsEUuUHNntkExDz4zQd2Y+iNTliPXm8295yFe9JmRN/vq2PpG3qb84uaFXlZs8KmR4MBdP1jMzlbjlRH0owr38/K7To1nGdcSU+KrIphveLbBKoFkGt6l6joOisS8FVpu/Lw1H+pajZmav9DSDhAoGBAK2YVFAA1MZiz8pONQXgNfx5cwM55mn+dwjJQeGrUOYDeaLtKlcKo4WzB7QI647J6ZmPIhJTTmm07qoriaJqnpz7sZlFQvwS1DeP0TyHUcDf0IH1uAXPJ8lnQirujKcWCA2uXnvo0pu+3I64O22u2RCkFp5YSEGoOPvnS69RQHIZAoGBAM5MotoO3IWn5Kw54hhQkfmLCZmN2xeztSwmweIMNsn9Fjk2j1kZnqqusxAC3errKnQb+Xmo3P/pJmYW9N5m7HT9kcuK7vJAdq6eIcVkCKo17RLKUhYhQd3HgqrjUQRsjYWkUKdW7UDM8NoyG5JXYOaQ+BFjcParOKXS4QKiRgAh"</span><span class="token punctuation">;</span>

        <span class="token class-name">PrivateKey</span> privateKey <span class="token operator">=</span> <span class="token function">convertStringToPrivateKey</span><span class="token punctuation">(</span>privateKeyStrOfEntB<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> decodedDesKey <span class="token operator">=</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>encryptedKey<span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"解密后的DES Key: "</span> <span class="token operator">+</span> decodedDesKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将字符串转换为私钥对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PrivateKey</span> <span class="token function">convertStringToPrivateKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> privateKeyString<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> privateKeyBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>privateKeyString<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PKCS8EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>privateKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 使用RSA私钥解密字符串</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> encryptedText<span class="token punctuation">,</span> <span class="token class-name">PrivateKey</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encryptedBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>encryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decryptedBytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>encryptedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decryptedBytes<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/92cedb8a8cb84adabb5912ad7a5325d8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">解密后的DES Key：</span></span></p></div><pre id="https://www.notion.so/38ef5f73f76645e8aa51c4ef618e62de" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>lLkL6UwL<span class="token operator">+</span><span class="token operator">/</span>uoy1RUhdPsV67NIP4a1eA7</span></span></span></code></pre><div id="https://www.notion.so/3aad87b58d5b455f8cf4a8a065b49c39" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/70514f54b238432c9ef128bd3c36ae09" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">用DES key对</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">encrypted_data</strong></em></span><span class="SemanticString">解密：</span></span></p></div><pre id="https://www.notion.so/2622f27ca1e04002bd53fac6b376c8ea" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">package</span> <span class="token namespace">encrypt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">SecretKey</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">SecretKeyFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">DESedeKeySpec</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TripleDesDecrypt</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 密钥字符串</span>
            <span class="token class-name">String</span> desKey <span class="token operator">=</span> <span class="token string">"lLkL6UwL+/uoy1RUhdPsV67NIP4a1eA7"</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 加密的字符串</span>
            <span class="token class-name">String</span> encryptedData <span class="token operator">=</span> <span class="token string">"KiKj8YAQeyX6U9CP0xuJTA=="</span><span class="token punctuation">;</span>

            <span class="token comment">// 将密钥字符串转换为密钥对象</span>
            <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> <span class="token function">convertStringToSecretKey</span><span class="token punctuation">(</span>desKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 解密字符串</span>
            <span class="token class-name">String</span> decryptedText <span class="token operator">=</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>encryptedData<span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"解密后的报文: "</span> <span class="token operator">+</span> decryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将密钥字符串转换为密钥对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SecretKey</span> <span class="token function">convertStringToSecretKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> keyString<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>keyString<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">DESedeKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESedeKeySpec</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">SecretKeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DESede"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> keyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 使用3DES密钥解密字符串</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> encryptedText<span class="token punctuation">,</span> <span class="token class-name">SecretKey</span> secretKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DESede/ECB/PKCS5Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encryptedBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>encryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decryptedBytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>encryptedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decryptedBytes<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/2b329d4fc7e9450bb3c8b2e28c37cc72" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">解密后的报文: </span></span></p></div><pre id="https://www.notion.so/59dce4d37b8f44f784677846c7530a5c" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">Hello</span><span class="token punctuation">,</span> <span class="token class-name">World</span><span class="token operator">!</span></span></span></span></code></pre><div id="https://www.notion.so/07aec1e29326453aabf83cf3620f987c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">OK，现在我们还有最后一步：验签，即我要确认解密后的”Hello, World!”是否是企业A发的，且是否被劫持并修改过，验证过程：</span></span></p></div><pre id="https://www.notion.so/0277681c39a74bffad250c2ac0de25b4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">package</span> <span class="token namespace">encrypt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RSASignatureExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 企业A的公钥</span>
            <span class="token class-name">String</span> publicKeyOfEntA <span class="token operator">=</span> <span class="token string">"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtLmnzL7sqrv5LsUt2LYs5nEKdlt+BIgbTT4SYutPgCNFR83AE95w7/cQHCG1T79Agp3WbwpJOT6tCLUBQ48V2rRA235ZOtlswMKM1WE9TM6AuyXCGJLIFuK9pShCx7+6jksSNtuGxf2YfTFxKnP7VfjxEZKn26aCiSqzXBptxesVfPgHIB4OSRZFT360jBP/38ci37Q3vHND2z5plPMfdNRqgGawMb0lNsnCFi28l5jetpzQ25mfTUxaP0dT+m4+uXHm6vAwrYal0i/p0UWwHgzVZUvKirZfHURYzZ4BWC9grbSAA7XMLaxhdR/J3pEGT6rA0onrhQUjafWTsVpVYwIDAQAB"</span><span class="token punctuation">;</span>
            <span class="token class-name">PublicKey</span> publicKey <span class="token operator">=</span> <span class="token function">convertStringToPublicKey</span><span class="token punctuation">(</span>publicKeyOfEntA<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 需要验签的字符串</span>
            <span class="token class-name">String</span> plaintext  <span class="token operator">=</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">;</span>
            <span class="token comment">// 签名串</span>
            <span class="token class-name">String</span> signature <span class="token operator">=</span> <span class="token string">"W2vPVeQtfIGLSYajA9PZzHuC0W7KPhfOXdC+osyBLYpYEm40NGshnKd8S8t5XMq6Tf/ZJ96fHeyS6XOIVjZCE0WZcl5J7s8uvkdjKKir35Itbj3hYidTVO1B93KdoAJRtjUd0NxaWN+uscJB5VepkNqayS4+wwyOf9HRQkcoRjNTzkHupUZlQ9bTedjIm3NK5U6qONbwqlEvgdYLWOW1DmXBdZ3UKbgTrlEmRYYHcI9xth1nbJr9YumENttHL0vzDFid1V3J5JqWN15jVfGPrUhSgZWeG8dQj3mP6uMQ5l2KRVLU7Ditvjy7MmINXmtHvKoeKyC5bO89y2em0TFfig=="</span><span class="token punctuation">;</span>
         
            <span class="token comment">// 验证签名</span>
            <span class="token keyword">boolean</span> isValid <span class="token operator">=</span> <span class="token function">verify</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"签名是否有效: "</span> <span class="token operator">+</span> isValid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

 
    <span class="token comment">// 验证签名</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token class-name">String</span> data<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">PublicKey</span> publicKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Signature</span> verifySignature <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"SHA256withRSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        verifySignature<span class="token punctuation">.</span><span class="token function">initVerify</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        verifySignature<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> signatureBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> verifySignature<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>signatureBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   <span class="token comment">// 将字符串转换为公钥对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PublicKey</span> <span class="token function">convertStringToPublicKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> publicKeyString<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidKeySpecException</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> publicKeyBytes <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>publicKeyString<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>publicKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/821689aaeeb44c10ab08f7e348f779e7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0fad189842c643139265c8e7e19cd293" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输出：</span></span></p></div><pre id="https://www.notion.so/16eeba0f37e9439f992f3672a0e097a9" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>签名是否有效<span class="token operator">:</span> <span class="token boolean">true</span></span></span></span></code></pre><div id="https://www.notion.so/ccb788ede41449efa64a67224714d0b5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">由此，整个过程结束。</span></span></p></div><div id="https://www.notion.so/ea121ec6f5b64f79beb9723d6587e326" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/da80c2bd5f564cf18c181d85905e07ea" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/da80c2bd5f564cf18c181d85905e07ea"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">总结</span></span></h2><div id="https://www.notion.so/afbcd3118dfa45a38ee344cd77033ac7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1、3 DES对称加密速度快，用来加密报文体</span></span></p></div><div id="https://www.notion.so/4c0b3627629a49be9678e78b403d4e47" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">2、RSA适用于对密钥加密</span></span></p></div><div id="https://www.notion.so/b830769d0ed7445daac8facf90103d1e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">3、企业B向企业A发消息，复用上述流程</span></span></p></div><div id="https://www.notion.so/a065474de032450ba898d482895aaceb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">4、加签验签过程，更安全的做法应该是加入一些双方约定的规则，比如对加签前的报文做一些变换，如字段排序、编码格式变换、加入特殊字符等方式。</span></span></p></div></article>
  <footer class="Footer">
  <div>&copy; 李正的自留地 2024</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>

</body>

</html>